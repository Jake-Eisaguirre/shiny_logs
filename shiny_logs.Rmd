---
title: "shiny_logs"
author: "Jake Eisaguirre"
date: "2023-01-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


if (!require(librarian)){
  install.packages("librarian")
  library(librarian)
}

# librarian downloads, if not already downloaded, and reads in needed packages

librarian::shelf(tidyverse, here, janitor, purrr, learnitdown, tidyr, stringr)

```

# load logs of interest
```{r}

files <- list.files(here("logs"))

data <- data.frame()

for (i in seq_along(files)){

  temp <- read_shinylogs(here("logs", files[i]))
    
  data <- rbind(data, temp)

}
```

```{r}
t <- data %>% 
  select(date, label, value) %>% 
  separate_longer_delim(value, ',')
```


# search log for `download_btn`
```{r}
log <- data %>% 
  select(session, date, user, label, value) %>% 
  separate_longer_delim(value, ',') %>% 
  filter(label %in% c("location") |
         str_detect(label,"download_btn") |
         str_detect(label, "bd")|
         str_detect(label, "amp")|
         str_detect(label, "muc_mic") |
         str_detect(label, "genom") |
         str_detect(label, ".clientdata_output")) %>% 
  mutate(value = str_remove_all(value, "list"),
         value = str_remove_all(value, ","),
         value = str_remove_all(value, "\\("),
         value = str_remove_all(value, "\\)"))
```

# visualize data
```{r}




ggplot(data = log, aes(x = user, y = label)) +
  geom_col()

```

